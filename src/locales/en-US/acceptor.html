<script type="text/html" data-help-name="wechat-acceptor">
  <p>
  	<span>在企业的管理端后台，进入需要设置接收消息的目标应用，点击“接收消息”的“设置API接收”按钮，进入配置页面。配置回调参数以及选择需要接收的事件类型</span>
  	<a href="https://developer.work.weixin.qq.com/document/path/90238">查看详情</a>
  </p>

  <blockquote>
  	<p>特别注意：企业微信服务器在五秒内收不到响应会断掉连接，并且重新发起请求，总共重试三次。如果企业在调试中，发现成员无法收到被动回复的消息，可以检查是否消息处理超时。</p>
  </blockquote>

  <h3>配置信息</h3>
  <dl class="message-properties">
  	<dt>
  		<span>接收 Url</span>
  		<span class="property-type">
  			<code>string</code>
  		</span>
  	</dt>
  	<dd>企业消息接收地址<code>node-red</code>访问地址拼接上<code>接收 Url</code>组成完整的企业消息接收地址, 将该地址配置到企业微信后台的接收消息 Url 中。</dd>
  	<dt class="optional">
  		<span>[超时响应]</span>
  		<span class="property-type">
  			<code>select</code>
  		</span>
  	</dt>
  	<dd>设置请求超时响应时间, 超过设定时间后会自动响应【针对企业微信服务请求会在<code>5</code>秒内超时自动返回<code>200</code>表示接收<code>OK</code>避免收到企业微信的重复消息】</dd>
  </dl>

  <h3>输出信息</h3>
  <ol class="node-ports">
  	<li>
  		<span>来自企业微信</span>
  		<dl class="message-properties">
  			<dt>
  				<span>topic</span>
  				<span class="property-type">
  					<code>string</code>
  				</span>
  			</dt>
  			<dd>来自企业微信的消息类型、事件类型，可以此来区分来不同消息或事件</dd>
  			<dt>
  				<span>payload</span>
  				<span class="property-type">
  					<code>object</code>
  				</span>
  			</dt>
  			<dd>来自企业微信的消息/事件数据载体</dd>
  		</dl>
  	</li>
  	<li>
  		<span>来自用户请求</span>
  		<dl class="message-properties">
  			<dt>
  				<span>topic</span>
  				<span class="property-type">
  					<code>string</code>
  				</span>
  			</dt>
  			<dd>
  				<div><code>/upload</code>：文件上传请求</div>
  				<div><code>/others</code>：其他请求</div>
  			<dt>
  				<span>payload</span>
  				<span class="property-type">
  					<code>object</code>
  				</span>
  			</dt>
  			<dd>用户请求数据载体</dl>
  		</dl>
  	</li>
  </ol>

  <h3>详细说明</h3>
  <ul>
  	<li>为了能够让自建应用和企业微信进行双向通信，企业可以在应用的管理后台开启接收消息模式。</li>
  	<li>开启接收消息模式的企业，需要提供可用的接收消息服务器URL（建议使用https）。</li>
  	<li>开启接收消息模式后，用户在应用里发送的消息会推送给企业后台。此外，还可配置地理位置上报等事件消息，当事件触发时企业微信会把相应的数据推送到企业的后台。</li>
  	<li>企业后台接收到消息后，可在回复该消息请求的响应包里带上新消息，企业微信会将该被动回复消息推送给用户。</li>
  </ul>
</script>
